● 🚀 项目启动和使用指南

  1. 启动项目

  # 使用Docker Compose启动所有服务
  docker-compose -f docker-compose.race.yml up -d

  # 查看服务状态
  docker-compose -f docker-compose.race.yml ps

  # 查看日志
  docker-compose -f docker-compose.race.yml logs -f

  2. 健康检查

  # 检查API服务是否正常
  curl http://localhost:5000/health

  3. 基本测试

  创建爬取任务

  # 测试简单URL
  curl -X POST http://localhost:5000/api/v1/scrape \
    -H "Content-Type: application/json" \
    -H "X-API-Key: demo-api-key-123" \
    -d '{
      "urls": ["https://example.com", "https://httpbin.org/html"],
      "scraper_type": "requests"
    }'

  检查任务状态

  # 使用返回的task_id检查状态
  curl -H "X-API-Key: demo-api-key-123" \
    http://localhost:5000/api/v1/tasks/{task_id}

  获取结果

  # 获取任务结果
  curl -H "X-API-Key: demo-api-key-123" \
    http://localhost:5000/api/v1/tasks/{task_id}/results

  4. 竞速模式测试

  触发竞速模式（成功率<70%）

  # 创建包含失败URL的任务
  curl -X POST http://localhost:5000/api/v1/scrape \
    -H "Content-Type: application/json" \
    -H "X-API-Key: demo-api-key-123" \
    -d '{
      "urls": [
        "https://example.com",
        "https://httpbin.org/status/404",
        "https://httpbin.org/status/500",
        "https://invalid-domain-xyz123.com"
      ],
      "scraper_type": "requests"
    }'

  5. 系统统计

  # 查看系统统计
  curl -H "X-API-Key: demo-api-key-123" \
    http://localhost:5000/api/v1/stats

  6. 停止项目

  # 停止所有服务
  docker-compose -f docker-compose.race.yml down

  # 完全清理（包括数据）
  docker-compose -f docker-compose.race.yml down -v

  📋 常用命令速查

  | 操作   | 命令                                                                                                                                                                                    |
  |------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | 启动服务 | docker-compose -f docker-compose.race.yml up -d                                                                                                                                       |
  | 查看日志 | docker-compose -f docker-compose.race.yml logs -f                                                                                                                                     |
  | 健康检查 | curl http://localhost:5000/health                                                                                                                                                     |
  | 创建任务 | curl -X POST -H "X-API-Key: demo-api-key-123" -H "Content-Type: application/json" -d '{"urls":["https://example.com"],"scraper_type":"requests"}' http://localhost:5000/api/v1/scrape |
  | 查看结果 | curl -H "X-API-Key: demo-api-key-123" http://localhost:5000/api/v1/tasks/{task_id}/results                                                                                            |

  🎯 竞速模式观察

  当requests成功率低于70%时，系统会自动：
  1. 将任务转入竞速队列
  2. 多个爬虫容器(newspaper/readability/trafilatura)同时竞争
  3. 第一个成功的爬虫结果会被采用
  4. 可以在日志中看到"🎯 [爬虫类型] 率先完成，使用其结果!"